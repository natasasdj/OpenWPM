CREATE TABLE IF NOT EXISTS http_requests(
  site_id INTEGER NOT NULL,
  link_id INTEGER NOT NULL,
  request_id INTEGER NOT NULL,
  url TEXT NOT NULL,
  top_level_url TEXT,
  method TEXT NOT NULL,
  referrer TEXT NOT NULL,
  headers TEXT NOT NULL,
  is_XHR BOOLEAN,
  is_frame_load BOOLEAN,
  is_full_page BOOLEAN,
  is_third_party_channel BOOLEAN,
  is_third_party_window BOOLEAN,
  triggering_origin TEXT,
  loading_origin TEXT,
  loading_href TEXT,
  req_call_stack TEXT,
  content_policy_type INTEGER NOT NULL,
  time_stamp TEXT NOT NULL,
  FOREIGN KEY (site_id) REFERENCES site_visits(site_id),
  FOREIGN KEY (link_id) REFERENCES site_visits(link_id),
  PRIMARY KEY (site_id, link_id, request_id)
);
